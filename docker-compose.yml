services:
  signal-api:
    image: bbernhard/signal-cli-rest-api:latest
    restart: unless-stopped
    ports:
      - "8080:8080"
    volumes:
      - ~/.local/share/signal-cli:/home/.local/share/signal-cli
    environment:
      - MODE=json-rpc

  penny:
    build: ./app
    restart: unless-stopped
    volumes:
      - ./app/penny:/app/penny
      - ./app/pyproject.toml:/app/pyproject.toml
      - ./data:/app/data
      - ./.env:/app/.env
    environment:
      - PYTHONUNBUFFERED=1
      - SIGNAL_API_URL=http://signal-api:8080
    depends_on:
      - signal-api
